# stock-price-predictor
LSTMによるNTTの株価データの予測。

---

##  概要

- 本プロジェクトでは、NTTの株価を対象に以下のステップで予測モデルの構築・評価を実施した：

1. 基本統計量やトレンド、季節性、異常値の確認（EDA：データ理解）  
2. モデルの選定（LSTMを採用）  
3. 欠損値補完や正規化などの前処理  
4. モデルの実装（LSTM構築）  
5. モデルのトレーニング  
6. 予測精度の評価と結果の分析（RMSE, R²）  
7. 改善案の検討および再トレーニング  
8. プレゼンテーション資料の作成 。

---

####　 プロジェクト構成

markdown

├── README.md
├── notebooks/  
│ ├── eda.ipynb # データの探索的分析（EDA）
│ ├── lstm_prediction.ipynb # プロトタイプのLSTMモデル
│ ├── lstm_prediction2.ipynb # LSTM層を4段にした実装
│ ├── lstm_prediction3.ipynb # ドロップアウト率を調整した実装
│ └── stock_price.csv # 株価データ
├── utils/ 
│ ├── processing_lstm.py # 前処理関数の実装
│ └── processing_lstm2.py # 別アプローチの前処理関数
└── models/ 
├── lstm_model.py # LSTMモデル構築・訓練・予測関数
├── lstm_model2.py # 別構成
└── lstm_model3.py # 別構成

markdown
---

#### 結果
- 使用データ：株価データの 80% を訓練用、残り 20% をテスト用に分割  
- 評価指標：二乗平均平方根誤差（RMSE）、決定係数（R²）
### 1層 LSTM（初期実装）
- rmse=1.918667448741605
- r2=0.9954236745834351

---

### 4層 LSTM＋ドロップアウト率 0.2（過学習抑制試行）  
- データの表現力を高めるという目的でLSTMを4層に拡張。
- 多層構造にしたことによる過学習を抑制するため各層の間にドロップアウト率0.2のドロップアウト層を導入。
- rmse=2.0589180715249484
- r2=0.9947301745414734
- 依然として高い水準を保っているものの、初期実装に比べて予測精度の悪化がみられた。
### ドロップアウト率を (0.2, 0.1, 0.05) に調整（最終実装）
- 原因として過剰なドロップアウトの影響で学習が阻害されたことが考えられたので、ドロップアウト率を（0.2,0.1,0.05）に設定してトレーニングを試みた。
- rmse=1.5762338540803946
- r2=0.9969114065170288
- 今回は初めの実装と比較しても精度の改善がみられた。
- これをもってlstm_model3.pyを本提出の最終成果物とする。