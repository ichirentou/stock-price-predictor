# stock-price-predictor
LSTMによるNTTの株価データの予測。

####　概要

NTTの株価予測モデルの構築という課題を、
1.　基本統計量やトレンド、季節性、異常値の確認（データの理解とEDA）
2.　モデルの選定
3.　欠損値補完や正規化（データの前処理）
4．　モデルの実装
5.　モデルのトレーニング
6.　予測精度の評価と結果の分析
7.　改善案の検討と再トレーニング
8.　プレゼンテーション資料の作成
という流れで行った。 
それぞれの実行はnotebookにより行った。

####　プロジェクト構造

├── README.md
|          
├── notebooks/
│    ├── lstm_prediction.ipynb  　　　　　 ##プロトタイプのLSTMモデル
|    ├── lstm_prediction2.ipynb　　　　　　##LSTM層を4段にした実装
|    ├── lstm_prediction3.ipynb           ##ドロップアウトの値を調整した実装
|    ├── eda.ipynb 
|    └── stock_price.csv    　　　　　　##株価のデータ
├── utils/
|     ├── processing_lstm.py           # データ前処理関数   
│     └── processing_lstm2.py                            
└── models/
    ├── lstm_model.py                  # LSTMモデルの構築と訓練、予測関数
    ├── lstm_model2.py                 # LSTMモデルの構築と訓練、予測関数
    └── lstm_model3.py                 # LSTMモデルの構築と訓練、予測関数

#### 結果
与えられたデータの8割をトレーニング用として用い、残り2割をテスト用として用いた。
予測精度の評価は二乗平均平方根誤差と決定係数により行った。
初めに導入したのは1段の層のLSTM予測精度は以下のとおりである。
rmse=1.918667448741605
r2=0.9954236745834351
高い予測精度を実現できたが、精度をさらに高めるために、以下の2点の改善を行い、lstm_model2.pyに実装した。
・データの表現力を高めるという目的でLSTMを4層に拡張。
・多層構造にしたことによる過学習を抑制するため各層の間にドロップアウト率0.2のドロップアウト層を導入。
結果は以下のとおりである。
rmse=2.0589180715249484
r2=0.9947301745414734
依然として高い水準を保っているものの、前回に比べて予測精度の悪化がみられた。
原因として過剰なドロップアウトの影響で学習が阻害されたことが考えられたので、ドロップアウト率を（0.2,0.1,0.05）に設定してトレーニングを試みた。結果は以下のとおりである。
rmse=1.5762338540803946
r2=0.9969114065170288
今回は初めの実装と比較しても精度の改善がみられた。
これをもってlstm_model3.pyを本提出の最終成果物とする。